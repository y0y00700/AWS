1장. S3 란?
한줄 : 파일 저장 서비스이다.
우리는 사진이나 동영상과 같은 파일들을 구글 드라이브나 iCloud에 저장한다.
S3는 이런 종류의 서비스라고 생각하면 된다.

S3를 사용하는 이유?
백엔드 서버를 구현하다보면 이미지 업로드 기능을 구현할 때가 많다.
그럼 이 이미지 파일을 어디에 저장해야 할까? EC2 내부에 이미지 파일을 저장할 수도 있다.
하지만 EC2에 쌓이는 파일이 너무 많아지면 지저분하게 된다.

S3는 파일 저장에 특화된 서비스이다. 파일 저장 뿐만 아니라 파일을 다운받는 것에 대해서도 최적화되어 
있는 서비스이다. 

따라서, 파일 업로드 기능을 구현할 때 AWS S3를 활용한다면 좋다.

2장. S3를 활용한 아키텍처 구성

이미지 업로드
1. client  이미지 업로드 API 로 요청 -> 2. EC2 요청을 받고 S3에 저장 요청
-> 3.S3에 이미지 업로드 , 이미지가 저장된 URL을 리턴.
-> 4. DB에 이미지가 저장된 URL을 저장.

이미지 파일 다운로드 과정
1. client 이미지 조회 API로 요청 -> 2. EC2 DB에 조회 SQL 전송
->3. RDS 저장되어있던 이미지 URL 응답 -> 4.사용자한테 이미지 URL 응답.
->5. 사용자가 이미지 URL을 사용할 경우 S3로부터 이미지 다운로드

3장. (실습) S3 버킷 생성하기.
※ 버킷(Bucket) 과 객체(Object) 
   버킷 ? 하나의 저장소 단위를 버킷이라 한다.
   객체 ? S3버킷에 업로드 된 파일을 객체라 한다.

S3 > 버킷 만들기
버킷 이름 
이 버킷의 퍼블릭 액세스 차단 설정 : 해제
그외에는 그대로 두고 생성

버킷 정책 설정
구체적으로 어떤 것들을 허용하는지 설정
정책(Policy)이란?
권한을 정의하는 JSON문서를 의미한다.
AWS는 기본적으로 대부분의 권한이 주어져 있지 않다.
AWS의 특정 소스에 접근하려면 권한을 허용해주어야 한다.
권한을 허용할 때 작성해야 하는게 정책이다.

편집 > 새문 추가 >작업 추가 S3 >GetObject(조회)
리소스 추가 > 리소스 ARN 에 설정했던 버킷 이름을 추가해 준다.
ARN ( Amazon Resource Number)

4장. (실습) S3에 파일 업로드 할 수 있도록 IAM에서 액세스 키 발급 받기.
AWS 에서 IAM 검색
IAM 대시보드 > 사용자 > 사용자 생성
권한 옵션 : 직접 정책 연결(체크)
권한 정책 : S3Full 검색 후 체크
생성
액세스 키 생성
AWS 외부에서 실행되는 애플리케이션
태크 생략
액세스 키를 따로 빼서 저장한다. 

해당 액세스키가 없으면, S3에 접근이 불가하다.

5장. S3를 활용해 Express 서버에 이미지 업로드 기능 구현.
강의자료 참고

6장. 비용나가지 않도록 종료
버킷에 쌓여있는 객체들을 삭제한다.
이후 생성했던 버킷을 삭제한다.



